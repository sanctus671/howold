<html>
<head>
	<title>How old app</title>
	<script src="js/jquery-1.9.1.js"></script>
	<script src="js/cordova.js"></script>
</head>
<body>


<form id="uploadImageForm" action="script.php" method="post" enctype="multipart/form-data">
    Select image to upload:
    <input type="file" name="fileToUpload" id="fileToUpload">
    <input type="submit" value="Upload Image" name="submit">
</form>

<script>
$('#uploadImageForm').on('submit',function(e){
	e.preventDefault();
	
	var files = document.getElementById('fileToUpload').files;
	var formData = new FormData();

	var file = files[0];


	// Add the file to the request.
	formData.append('fileToUpload', file, file.name);	
	
$.post	
	
	var xhr = new XMLHttpRequest();
	xhr.open('POST', 'http://www.taylorhamling.com/HowOld/script.php', true);
	xhr.onload = function (data) {
		if (xhr.status === 200) {
			// File(s) uploaded.
			var response = $.parseJSON(data.target.response);
			if (response.result === "error"){
				console.log(response.msg);
			}
			else{
			console.log(response);
				//send away to microsoft
				$(function() {
					var params = {
						// Specify your subscription key
						'subscription-key': '1e5ea185c56f4c9fbe3204031489417d',
						// Specify values for optional parameters, as needed
						// analyzesFaceLandmarks: "false",
						 analyzesAge: "true",
						 analyzesGender: "true",
						// analyzesHeadPose: "false",
					};
					 
					$.ajax({
						url: 'https://api.projectoxford.ai/face/v0/detections?' + $.param(params),
						type: 'POST',
						contentType: 'application/json',
						data: '{url:"http://taylorhamling.com/HowOld/' + response.url + '"}'
					})
					.done(function(data) {
						console.log(data);
					})
					.fail(function() {
						alert("error");
					});
				});				
			}
		} 
		else {
			alert('An error occurred!');
		}
	};	

	xhr.send(formData);


})
	
</script>




</body>


</html>	
	